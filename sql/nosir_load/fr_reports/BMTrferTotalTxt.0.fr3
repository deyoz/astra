<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.7.66" DotMatrixReport="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" PrintOptions.ShowDialog="False" ReportOptions.CreateDate="39010,7781246296" ReportOptions.Description.Text="" ReportOptions.LastChange="41576,4843995602" ScriptLanguage="PascalScript" ScriptText.Text="var  &#13;&#10;  pageWidth: Integer;&#13;&#10;  tot_pcs, tot_weight: Integer;&#13;&#10;  tot_trfer_pcs, tot_trfer_weight: Integer;&#13;&#10;  HorizLine: String;  &#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  i:integer;    &#13;&#10;begin&#13;&#10;  pageWidth:=StrToInt(&#60;page_width&#62;);&#13;&#10;  HorizLine:='';&#13;&#10;  for i:=0 to pageWidth-1 do HorizLine := HorizLine + '-';&#13;&#10;    &#13;&#10;  if not(Engine.FinalPass) then&#13;&#10;  begin&#13;&#10;    tot_pcs :=0;&#13;&#10;    tot_weight :=0;&#13;&#10;    tot_trfer_pcs :=0;&#13;&#10;    tot_trfer_weight :=0;        &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var                           &#13;&#10;  str:string;&#13;&#10;  l:integer;      &#13;&#10;begin                           &#13;&#10;  str:=Format( &#60;page_number_fmt&#62;, [ &#60;PAGE#&#62;, &#60;TOTALPAGES#&#62; ] );&#13;&#10;  l:=pageWidth-Length(str);&#13;&#10;  if l&#60;0 then l:=0;                                              &#13;&#10;  PageNumberMemo.Text := Format( '%*s', [ l, ''] ) + str;&#13;&#10;  if StrToInt(&#60;test_server&#62;) = 0 then    &#13;&#10;    HeaderTopMemo.Text := &#60;page_header_top&#62;&#13;&#10;  else&#13;&#10;    HeaderTopMemo.Text := &#60;test_str&#62;  + #13#10 + &#60;page_header_top&#62;;                                                    &#13;&#10;  HeaderCenterMemo.Text := &#60;page_header_center&#62; + #13#10 + HorizLine;&#13;&#10;  HeaderBottomMemo.Text := &#60;page_header_bottom&#62; + #13#10 + HorizLine;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure AirpArvGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  airp_arv_name:string;&#13;&#10;  l:integer;                                                &#13;&#10;begin&#13;&#10;  airp_arv_name:=&#60;v_bm_trfer.&#34;airp_arv_name&#34;&#62;;&#13;&#10;  l:=(pageWidth - Length(airp_arv_name)) div 2;    &#13;&#10;  if l&#60;0 then l:=0;&#13;&#10;  AirpArvGroupMemo.Text := Format( '%*s', [l, ''] ) + airp_arv_name;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure LastTargetGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  last_target:string;&#13;&#10;  l:integer;    &#13;&#10;begin&#13;&#10;  if Length(&#60;v_bm_trfer.&#34;last_target&#34;&#62;) then&#13;&#10;  begin              &#13;&#10;    LastTargetGroupHeader.visible := true;  &#13;&#10;    last_target:=&#60;v_bm_trfer.&#34;last_target&#34;&#62;;&#13;&#10;    l:=(pageWidth - Length(last_target)) div 2;    &#13;&#10;    if l&#60;0 then l:=0;&#13;&#10;    LastTargetGroupMemo.Text := Format( '%*s', [l, ''] ) + last_target;        &#13;&#10;  end              &#13;&#10;  else&#13;&#10;    LastTargetGroupHeader.visible := false;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ClassGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  total_in_class, class_name:string;              &#13;&#10;  i,l:integer;    &#13;&#10;begin&#13;&#10;  class_name := &#60;v_bm_trfer.&#34;class_name&#34;&#62;;                                           &#13;&#10;  l := Length(class_name);                                  &#13;&#10;  total_in_class :=&#13;&#10;    Format( &#60;total_in_class_fmt&#62;,         &#13;&#10;            [ '%',&#13;&#10;              StrToInt(&#60;v_bm_trfer.&#34;amount&#34;&#62;),&#13;&#10;              StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;) ] );&#13;&#10;  i:=Pos('%',total_in_class);&#13;&#10;  if i&#62;0 then&#13;&#10;  begin              &#13;&#10;    Delete(total_in_class,i,l);&#13;&#10;    Insert(class_name,total_in_class,i);&#13;&#10;  end;              &#13;&#10;  TotalInClassMemo.Text := total_in_class;       &#13;&#10;end;    &#13;&#10;&#13;&#10;procedure ToRampGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if &#60;v_bm_trfer.&#34;to_ramp&#34;&#62; &#60;&#62; '' then           &#13;&#10;  begin&#13;&#10;    ToRampGroupHeader.visible := true;&#13;&#10;    ToRampGroupMemo.Text := '  ' + &#60;v_bm_trfer.&#34;to_ramp&#34;&#62;                                                            &#13;&#10;  end&#13;&#10;  else            &#13;&#10;    ToRampGroupHeader.visible := false;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure BagNameGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  offset: string;                                        &#13;&#10;begin&#13;&#10;  if &#60;v_bm_trfer.&#34;bag_name&#34;&#62; &#60;&#62; '' then           &#13;&#10;  begin&#13;&#10;    offset := '  ';&#13;&#10;    if &#60;v_bm_trfer.&#34;to_ramp&#34;&#62; &#60;&#62; '' then&#13;&#10;      offset := offset + '  ';                                                                              &#13;&#10;    BagNameGroupHeader.visible := true;&#13;&#10;    BagNameGroupMemo.Text := offset + &#60;v_bm_trfer.&#34;bag_name&#34;&#62;                                                            &#13;&#10;  end&#13;&#10;  else            &#13;&#10;    BagNameGroupHeader.visible := false;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PrTrferGroupFooterOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if not(Engine.FinalPass) then&#13;&#10;  begin&#13;&#10;    tot_pcs :=    tot_pcs +    SUM(StrToInt(&#60;v_bm_trfer.&#34;num&#34;&#62;));&#13;&#10;    tot_weight := tot_weight + SUM(StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;));&#13;&#10;    if MAX(StrToInt(&#60;v_bm_trfer.&#34;pr_trfer&#34;&#62;))&#60;&#62;0 then&#13;&#10;    begin                &#13;&#10;      tot_trfer_pcs :=    tot_trfer_pcs +    SUM(StrToInt(&#60;v_bm_trfer.&#34;num&#34;&#62;));&#13;&#10;      tot_trfer_weight := tot_trfer_weight + SUM(StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;));&#13;&#10;    end;                &#13;&#10;  end;&#13;&#10;  &#13;&#10;  if MAX(StrToInt(&#60;v_bm_trfer.&#34;pr_trfer&#34;&#62;))=0 then&#13;&#10;    PrTrferFooterMemo.Text := Format( &#60;total_not_trfer_fmt&#62;, &#13;&#10;                                      [ SUM(StrToInt(&#60;v_bm_trfer.&#34;num&#34;&#62;)),&#13;&#10;                                        SUM(StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;)) ] ) + #13#10 + HorizLine                                                    &#13;&#10;  else&#13;&#10;    PrTrferFooterMemo.Text := Format( &#60;total_trfer_fmt&#62;, &#13;&#10;                                      [ SUM(StrToInt(&#60;v_bm_trfer.&#34;num&#34;&#62;)),&#13;&#10;                                        SUM(StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;)) ] ) + #13#10 + HorizLine;    &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure LastTargetGroupFooterOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  //    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportFooterOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  ReportFooterMemo.Text := #13#10+                                   &#13;&#10;                           Format( &#60;report_footer&#62;,&#13;&#10;                                   [ tot_pcs, tot_weight, tot_trfer_pcs, tot_trfer_weight ]) + #13#10 + HorizLine;      &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C656674020803546F7002100844617461736574730100095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" PrintIfEmpty="False" HGuides.Text="" VGuides.Text="">
    <TfrxReportSummary Name="ReportSummary1" Height="15,11811024" Left="0" Top="653,85869" Width="718,1107" Stretched="True">
      <TfrxMemoView Name="ReportSummaryMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[report_summary]"/>
    </TfrxReportSummary>
    <TfrxGroupHeader Name="LastTargetGroupHeader" Height="15,11811024" Left="0" Top="200,31509" Width="718,1107" OnBeforePrint="LastTargetGroupHeaderOnBeforePrint" Condition="v_bm_trfer.&#34;last_target&#34;">
      <TfrxMemoView Name="LastTargetGroupMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="LastTargetGroupMemo"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData4" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="15,11811024" Left="0" ParentFont="False" Top="351,49629" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSetName="v_bm_trfer" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11812" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[(&#60;v_bm_trfer.&#34;str&#34;&#62;)]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="ClassGroupHeader" Height="15,11811024" Left="0" Top="238,11039" Width="718,1107" OnBeforePrint="ClassGroupHeaderOnBeforePrint" Condition="v_bm_trfer.&#34;class&#34;">
      <TfrxMemoView Name="TotalInClassMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="TotalInClassMemo"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="PrTrferGroupHeader" Height="0" Left="0" Top="177,63791" Visible="False" Width="718,1107" Condition="v_bm_trfer.&#34;pr_trfer&#34;"/>
    <TfrxGroupFooter Name="LastTargetGroupFooter" Height="15,11811024" Left="0" Top="457,32313" Width="718,1107" OnBeforePrint="LastTargetGroupFooterOnBeforePrint">
      <TfrxMemoView Name="Memo3" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[HorizLine]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="BagNameGroupFooter" Height="0" Left="0" Top="389,29159" Visible="False" Width="718,1107"/>
    <TfrxGroupFooter Name="ClassGroupFooter" Height="0" Left="0" Top="434,64595" Visible="False" Width="718,1107" Stretched="True"/>
    <TfrxFooter Name="ReportFooter" Height="15,11811024" Left="0" Top="532,91373" Width="718,1107" OnBeforePrint="ReportFooterOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="ReportFooterMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="ReportFooterMemo"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="AirpArvGroupHeader" Height="15,11811024" Left="0" Top="139,84261" Width="718,1107" OnBeforePrint="AirpArvGroupHeaderOnBeforePrint" Condition="v_bm_trfer.&#34;airp_arv&#34;">
      <TfrxMemoView Name="AirpArvGroupMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="AirpArvGroupMemo"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="BagNameGroupHeader" Height="15,11811024" Left="0" Top="313,70099" Width="718,1107" OnBeforePrint="BagNameGroupHeaderOnBeforePrint" Condition="v_bm_trfer.&#34;bag_name&#34;">
      <TfrxMemoView Name="BagNameGroupMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="18,89765" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="BagNameGroupMemo"/>
    </TfrxGroupHeader>
    <TfrxPageHeader Name="PageHeader1" Height="60,47248" Left="0" Top="18,89765" Width="718,1107" OnBeforePrint="PageHeader1OnBeforePrint" Stretched="True">
      <TfrxMemoView Name="HeaderTopMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="HeaderTopMemo"/>
      <TfrxMemoView Name="HeaderBottomMemo" Align="baWidth" Left="0" Top="45,35436" Width="718,1107" Height="15,11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="HeaderBottomMemo"/>
      <TfrxMemoView Name="PageNumberMemo" Align="baWidth" Left="0" Top="15,11812" Width="718,1107" Height="15,11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="PageNumberMemo"/>
      <TfrxMemoView Name="HeaderCenterMemo" Align="baWidth" Left="0" Top="30,23624" Width="718,1107" Height="15,11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="HeaderCenterMemo"/>
    </TfrxPageHeader>
    <TfrxGroupFooter Name="PrTrferGroupFooter" Height="15,11811024" Left="0" Top="495,11843" Width="718,1107" OnBeforePrint="PrTrferGroupFooterOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="453,5436" Top="0" Width="264,5671" Height="15,11811024" Visible="False" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[MAX(StrToInt(&#60;v_bm_trfer.&#34;pr_trfer&#34;&#62;))]&#13;&#10;[SUM(StrToInt(&#60;v_bm_trfer.&#34;num&#34;&#62;))]&#13;&#10;[SUM(StrToInt(&#60;v_bm_trfer.&#34;weight&#34;&#62;))]"/>
      <TfrxMemoView Name="PrTrferFooterMemo" Align="baClient" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="PrTrferFooterMemo"/>
    </TfrxGroupFooter>
    <TfrxPageFooter Name="PageFooter1" Height="15,11811024" Left="0" Top="691,65399" Width="718,1107">
      <TfrxMemoView Name="TotalMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[page_footer_top]"/>
    </TfrxPageFooter>
    <TfrxGroupFooter Name="ToRampGroupFooter" Height="0" Left="0" Top="411,96877" Width="718,1107"/>
    <TfrxChild Name="Child1" Height="22,67718" Left="0" Top="570,70903" Width="718,1107"/>
    <TfrxGroupHeader Name="ToRampGroupHeader" Height="15,11811024" Left="0" Top="275,90569" Width="718,1107" OnBeforePrint="ToRampGroupHeaderOnBeforePrint" Condition="v_bm_trfer.&#34;to_ramp&#34;">
      <TfrxMemoView Name="ToRampGroupMemo" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="15,11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="ToRampGroupMemo"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
