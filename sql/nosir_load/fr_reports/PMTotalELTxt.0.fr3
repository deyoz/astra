<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.15.13" DotMatrixReport="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" PrintOptions.ShowDialog="False" ReportOptions.CreateDate="39010.7781246296" ReportOptions.Description.Text="" ReportOptions.LastChange="43440.6007648148" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  adl, chd, inf, fem, male: Integer;&#13;&#10;  tot_adl, tot_chd, tot_inf, tot_fem: Integer;&#13;&#10;  tot_seats, tot_pcs: Integer;&#13;&#10;  tot_weight, tot_cabin, tot_exbag_kg, tot_exbag_pc: Integer;&#13;&#10;  jmp, xcr, dhc, mos: Integer;                                                                                 &#13;&#10;  tot_jmp, tot_xcr, tot_dhc, tot_mos: Integer;                                                                                 &#13;&#10;  pageWidth: Integer;&#13;&#10;  HorizLine: String;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  i:integer;                             &#13;&#10;begin&#13;&#10;  pageWidth:=StrToInt(&#60;page_width&#62;);&#13;&#10;  HorizLine:='';                        &#13;&#10;  for i:=0 to pageWidth-1 do HorizLine := HorizLine + '-';&#13;&#10;    &#13;&#10;  if not Engine.FinalPass then&#13;&#10;  begin&#13;&#10;    adl := 0;&#13;&#10;    chd := 0;&#13;&#10;    inf := 0;                 &#13;&#10;    fem := 0;                 &#13;&#10;    male := 0;                 &#13;&#10;    tot_adl := 0;&#13;&#10;    tot_chd := 0;&#13;&#10;    tot_inf := 0;&#13;&#10;    tot_fem := 0;&#13;&#10;    tot_seats := 0;&#13;&#10;    tot_pcs := 0;&#13;&#10;    tot_weight := 0;&#13;&#10;    tot_cabin := 0;&#13;&#10;    tot_exbag_kg := 0;&#13;&#10;    tot_exbag_pc := 0;&#13;&#10;    jmp := 0;&#13;&#10;    xcr := 0;&#13;&#10;    dhc := 0;&#13;&#10;    mos := 0;                        &#13;&#10;    tot_jmp := 0;                                  &#13;&#10;    tot_xcr := 0;                                  &#13;&#10;    tot_dhc := 0;                                  &#13;&#10;    tot_mos := 0;                                  &#13;&#10;  end;&#13;&#10;  AirpArvGroupHeader.Visible := &#60;airp_arv_name&#62; = '';                                                     &#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var  &#13;&#10;  str:string;&#13;&#10;  l:integer;                        &#13;&#10;begin    &#13;&#10;  str:=Format( &#60;page_number_fmt&#62;, [ &#60;PAGE#&#62;, &#60;TOTALPAGES#&#62; ] );&#13;&#10;  l:=pageWidth-Length(str);&#13;&#10;  if l&#60;0 then l:=0;                                              &#13;&#10;  PageNumberMemo.Text := Format( '%*s', [ l, ''] ) + str;&#13;&#10;  if StrToInt(&#60;test_server&#62;) = 0 then    &#13;&#10;    HeaderTopMemo.Text := &#60;page_header_top&#62;&#13;&#10;  else&#13;&#10;    HeaderTopMemo.Text := &#60;test_str&#62;  + #13#10 + &#60;page_header_top&#62;;                                                    &#13;&#10;  HeaderCenterMemo.Text := &#60;page_header_center&#62; + #13#10 + HorizLine;&#13;&#10;  HeaderBottomMemo.Text := &#60;page_header_bottom&#62; + #13#10 + HorizLine;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure AirpArvGroupHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  airp_arv_name:string;&#13;&#10;  l:integer;                                                &#13;&#10;begin&#13;&#10;  airp_arv_name:=&#60;v_pm_trfer.&#34;airp_arv_name&#34;&#62;;&#13;&#10;  l:=(pageWidth - Length(airp_arv_name)) div 2;    &#13;&#10;  if l&#60;0 then l:=0;                &#13;&#10;  AirpArvGroupMemo.Text := Format( '%*s', [l, ''] ) + airp_arv_name;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    if &#60;v_pm_trfer.&#34;pers_type&#34;&#62; = 'ADL' then Inc(adl);&#13;&#10;    if &#60;v_pm_trfer.&#34;pers_type&#34;&#62; = 'CHD' then Inc(chd);&#13;&#10;    if &#60;v_pm_trfer.&#34;pers_type&#34;&#62; = 'INF' then Inc(inf);&#13;&#10;    if &#60;v_pm_trfer.&#34;gender&#34;&#62; = 'F' then Inc(fem);&#13;&#10;    if &#60;v_pm_trfer.&#34;gender&#34;&#62; = 'M' then Inc(male);&#13;&#10;    if &#60;v_pm_trfer.&#34;seat_no&#34;&#62; = 'JMP' then jmp := jmp + StrToInt(&#60;v_pm_trfer.&#34;seats&#34;&#62;);                                                       &#13;&#10;    if &#60;v_pm_trfer.&#34;crew_type&#34;&#62; = 'XCR' then Inc(xcr);&#13;&#10;    if &#60;v_pm_trfer.&#34;crew_type&#34;&#62; = 'DHC' then Inc(dhc);&#13;&#10;    if &#60;v_pm_trfer.&#34;crew_type&#34;&#62; = 'MOS' then Inc(mos);&#13;&#10;      &#13;&#10;  if not Engine.FinalPass then&#13;&#10;  begin&#13;&#10;    tot_exbag_pc := tot_exbag_pc + &#60;v_pm_trfer.&#34;excess_pc&#34;&#62;;                                                                                                                                          &#13;&#10;    tot_exbag_kg := tot_exbag_kg + &#60;v_pm_trfer.&#34;excess_kg&#34;&#62;;&#13;&#10;  end;                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ClassGroupFooterOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  total_in_class, class_name:string;              &#13;&#10;  i,l:integer;                        &#13;&#10;begin&#13;&#10;  class_name := MAX(&#60;v_pm_trfer.&#34;class_name&#34;&#62;);                                           &#13;&#10;  l := Length(class_name);&#13;&#10;  total_in_class := &#13;&#10;    Format( &#60;total_in_class_fmt&#62;,&#13;&#10;            [ '%',&#13;&#10;              IntToStr(male) + '/' + IntToStr(fem),&#13;&#10;              SUM(StrToInt(&#60;v_pm_trfer.&#34;seats&#34;&#62;)),&#13;&#10;              chd, inf,                                &#13;&#10;              SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_amount&#34;&#62;)),  &#13;&#10;              SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_weight&#34;&#62;)),  &#13;&#10;              SUM(StrToInt(&#60;v_pm_trfer.&#34;rk_weight&#34;&#62;)),&#13;&#10;              xcr, dhc, mos, jmp                                                         &#13;&#10;               ] );&#13;&#10;  i:=Pos('%',total_in_class);&#13;&#10;  if i&#62;0 then&#13;&#10;  begin              &#13;&#10;    Delete(total_in_class,i,l);&#13;&#10;    Insert(class_name,total_in_class,i);&#13;&#10;  end;              &#13;&#10;  TotalInClassMemo.Text := HorizLine + #13#10 + total_in_class + #13#10 + HorizLine;&#13;&#10;  if not Engine.FinalPass then&#13;&#10;  begin&#13;&#10;    tot_adl := tot_adl + adl;&#13;&#10;    tot_chd := tot_chd + chd;&#13;&#10;    tot_inf := tot_inf + inf;&#13;&#10;    tot_fem := tot_fem + fem;&#13;&#10;    tot_seats :=  tot_seats +  SUM(StrToInt(&#60;v_pm_trfer.&#34;seats&#34;&#62;));&#13;&#10;    tot_pcs :=    tot_pcs +    SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_amount&#34;&#62;));&#13;&#10;    tot_weight := tot_weight + SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_weight&#34;&#62;));&#13;&#10;    tot_cabin :=  tot_cabin +  SUM(StrToInt(&#60;v_pm_trfer.&#34;rk_weight&#34;&#62;));&#13;&#10;    tot_jmp := tot_jmp + jmp;                                                              &#13;&#10;    tot_xcr := tot_xcr + xcr;                                                              &#13;&#10;    tot_dhc := tot_dhc + dhc;                                                              &#13;&#10;    tot_mos := tot_mos + mos;                                                              &#13;&#10;  end;&#13;&#10;  adl := 0;&#13;&#10;  chd := 0;&#13;&#10;  inf := 0;&#13;&#10;  fem := 0;&#13;&#10;  male := 0;&#13;&#10;  jmp := 0;&#13;&#10;  xcr := 0;&#13;&#10;  dhc := 0;&#13;&#10;  mos := 0;                        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  str_exbag: string;                                                  &#13;&#10;begin&#13;&#10;  if Engine.FinalPass then&#13;&#10;  begin&#13;&#10;    if(tot_exbag_kg &#60;&#62; 0) and (tot_exbag_pc &#60;&#62; 0)then&#13;&#10;    begin&#13;&#10;      str_exbag := IntToStr(tot_exbag_kg) + &#60;kg&#62; + '/' + IntToStr(tot_exbag_pc) + &#60;pc&#62;;                                                                                                                                                                                                           &#13;&#10;    end&#13;&#10;    else if(tot_exbag_kg &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      str_exbag := IntToStr(tot_exbag_kg) + &#60;kg&#62;;                                                                                                                                                                                                             &#13;&#10;    end              &#13;&#10;    else if(tot_exbag_pc &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      str_exbag := IntToStr(tot_exbag_pc) + &#60;pc&#62;;                                                                                                                                                                                                             &#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin                &#13;&#10;      str_exbag := '0';     &#13;&#10;    end;&#13;&#10;    TotalMemo.Text := HorizLine+#13#10+                                   &#13;&#10;                      Format( &#60;page_footer_top&#62;,&#13;&#10;                              [ tot_seats, IntToStr(tot_adl) + '/' + IntToStr(tot_fem), tot_chd, tot_inf, tot_pcs, tot_weight, tot_cabin, str_exbag,&#13;&#10;                              tot_xcr, tot_dhc, tot_mos, tot_jmp ] );&#13;&#10;  end;                                                                &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.&#13;&#10;&#13;&#10;&#13;&#10;  " OnStartReport="frxReport1OnStartReport" OnStopReport="frxReport1OnStopReport" PropData="0844617461736574730100095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page2" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" BackPictureVisible="False" BackPicturePrintable="False" PrintIfEmpty="False" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="124.72448024" Left="0" Top="351.49629" Width="718.1107" OnBeforePrint="PageFooter1OnBeforePrint">
      <TfrxMemoView Name="TotalMemo" Align="baWidth" Left="0" Top="15.11812" Width="718.1107" Height="109.60636024" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="---------------------------------------------------------------------------&#13;&#10;‚á¥£®&#13;&#10;Šà¥á¥« ‚‡/†         Œ     Œ¥áâ   ‚¥á    /ª«   « â.   XCR DHC MOS JMP &#13;&#10;6      4/0     0      0      0      0      0      0       1   0   0   4  &#13;&#10;®¤¯¨áì&#13;&#10;                              &#13;&#10;‘ä®à¬¨à®¢ ­® 06.12.18 14:20"/>
      <TfrxMemoView Name="Memo4" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11811024" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="*XCR, DHC, MOS included in Total Pax"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData4" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="15.77953" Left="0" ParentFont="False" Top="200.31509" Width="718.1107" OnBeforePrint="MasterData4OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="v_pm_trfer" DataSetName="v_pm_trfer" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[(&#60;v_pm_trfer.&#34;str&#34;&#62;)]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="60.47248" Left="0" Top="18.89765" Width="718.1107" OnBeforePrint="PageHeader1OnBeforePrint" Stretched="True">
      <TfrxMemoView Name="HeaderTopMemo" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="€‘‘€†ˆ‘Š€Ÿ ‚…„ŽŒŽ‘’œ                                  €ŽŽ’ „ŽŒŽ„…„Ž‚Ž"/>
      <TfrxMemoView Name="HeaderBottomMemo" Align="baWidth" Left="0" Top="45.35436" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="€‘‘€†ˆ› (§ à¥£)&#13;&#10;¥£ ” ¬¨«¨ï       ®« Š« ü ¬    Œ   £ ¦  /ª«  üü ¡ £.¡¨à®ª   ¥¬ àª¨  &#13;&#10;---------------------------------------------------------------------------"/>
      <TfrxMemoView Name="PageNumberMemo" Align="baWidth" Left="0" Top="15.11812" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="                                                                ‘âà. 1 ¨§ 1"/>
      <TfrxMemoView Name="HeaderCenterMemo" Align="baWidth" Left="0" Top="30.23624" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="‚« ¤¥«¥æ ¨«¨ Ž¯¥à â®à: “—…€Ÿ  ŒŽ‘ŠŽ‚‘Š€Ÿ&#13;&#10;ü à¥©á    ü ‚‘     ’¨¯‚‘ ‘â. €/¯ ¢ë«¥â                          „ â   ‚à¥¬ï&#13;&#10;Y1001     TST        ’“5     „ŽŒŽ„…„Ž‚Ž                         05.12 11:00&#13;&#10;---------------------------------------------------------------------------"/>
    </TfrxPageHeader>
    <TfrxGroupHeader Name="ClassGroupHeader" Height="0" Left="0" Top="177.63791" Visible="False" Width="718.1107" Condition="v_pm_trfer.&#34;class&#34;" Stretched="True"/>
    <TfrxGroupFooter Name="ClassGroupFooter" Height="15.11811024" Left="0" Top="238.11039" Width="718.1107" OnBeforePrint="ClassGroupFooterOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="TotalInClassMemo" Align="baClient" Left="0" Top="0" Width="718.1107" Height="15.11811024" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="---------------------------------------------------------------------------&#13;&#10;‚á¥£® ¢ ª« áá¥   M/F      Šàá    Œ  £.    /ª«       XCR DHC MOS JMP&#13;&#10;ŠŽŽŒ           4/0        6   0   0  0/0       0         1   0   0   4&#13;&#10;---------------------------------------------------------------------------"/>
      <TfrxMemoView Name="Memo3" Align="baRight" Left="498.89796" Top="0" Width="219.21274" Height="15.11811024" Visible="False" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[MAX(&#60;v_pm_trfer.&#34;class_name&#34;&#62;)]&#13;&#10;[SUM(StrToInt(&#60;v_pm_trfer.&#34;seats&#34;&#62;))]&#13;&#10;[SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_amount&#34;&#62;))]&#13;&#10;[SUM(StrToInt(&#60;v_pm_trfer.&#34;bag_weight&#34;&#62;))]&#13;&#10;[SUM(StrToInt(&#60;v_pm_trfer.&#34;rk_weight&#34;&#62;))]"/>
    </TfrxGroupFooter>
    <TfrxFooter Name="ReportFooter" Height="15.1181102362205" Left="0" Top="275.90569" Width="718.1107">
      <TfrxSubreport Name="Subreport1" Left="0" Top="0" Width="94.48825" Height="15.11811024" ShowHint="False" Page="Page1"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="AirpArvGroupHeader" Height="15.11812" Left="0" Top="139.84261" Width="718.1107" OnBeforePrint="AirpArvGroupHeaderOnBeforePrint" Condition="v_pm_trfer.&#34;airp_arv&#34;" Stretched="True">
      <TfrxMemoView Name="AirpArvGroupMemo" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11811024" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="                                   ‘Ž—ˆ"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" BackPictureVisible="False" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="15.11812" Left="0" Top="56.69295" Width="718.1107" ColumnWidth="0" ColumnGap="0" DataSet="v_pm_total" DataSetName="v_pm_total" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[(&#60;v_pm_total.&#34;str&#34;&#62;)]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="15.11812" Left="0" Top="18.89765" Width="718.1107" Stretched="True">
      <TfrxMemoView Name="HeaderMemo" Align="baWidth" Left="0" Top="0" Width="718.1107" Height="15.11812" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Text="[subreport_header]"/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>
